<!DOCTYPE html>
<html>
<body>

<h2>Savings Calculator</h2>

<form action="">
  <label for="savings">Initial Savings:</label><br>
  <input type="number" id="savings" name="savings"><br>
  <label for="interest">Interest Rate (% Yearly):</label><br>
  <input type="number" step=".01" id="interest" name="interest"><br>
  <label for="period">Period (Year):</label><br>
  <input type="number" id="period" name="period"><br>
  <br>
  <button type="button" onclick="runScript()">Calculate interest</button>
  <br>
  <br>
  <h3 id="result"></h3>
</form> 
<div><canvas id="chart"></canvas> <!-- Tambahkan elemen untuk grafik
-->
</div>

</body>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  class SavingsCalculator{
    constructor(initialAmount, interestRate, period){
        this._initialAmount = initialAmount;
        this._interestRate = interestRate;
        this._period = period;
    }

    get initialAmount(){
        return this._initialAmount;
    }

    set initialAmount(value){
        this._initialAmount = value;
    }

    get interestRate(){
        return this._interestRate;
    }

    set interestRate(value){
        this._interestRate = value;
    }

    get period(){
        return this._period;
    }

    set period(value){
        this._period = value;
    }

    calculateInterest(){
      return this._initialAmount * (this._interestRate/100) * this._period
    }

    calculateYearlyInterest(){
      const yearlyInterest = [];
      let totalAmount = this._initialAmount;

      for (let year = 1; year <= this._period; year++){
        const interest = (totalAmount * this._interestRate)/100;
        totalAmount += interest;
        yearlyInterest.push({ year, interest: interest.toFixed(2), totalAmount});
      }
      return yearlyInterest;
    }
  }

  class ChartManager{
    constructor(){
      this.chart = null;
    }

    createChart(data){
      const ctx = document.getElementById('chart').getContext('2d');

      this.chart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: data.map(entry => `Tahun $(entry.year)`),
          datasets: [{
            label: 'Yearly Interest',
            data: data.map(entry => entry.interest),
            borderWidth: 1
          }]
        },
        options: {
          scales: {
            y: {
              beginAtZero: true
            }
          }
        }
      });
    }
  }


function runScript(){
  var initialAmount = parseFloat(document.getElementById('savings').value);
  var interestRate = parseFloat(document.getElementById('interest').value);
  var period = parseFloat(document.getElementById('period').value);

  var calculator = new SavingsCalculator(initialAmount, interestRate, period);
  var interest = calculator.calculateInterest();
  //console.log(interest);
  var resultElement = document.getElementById('result');
  isNaN(interest) ? resultElement.innerHTML = `Rp 0` : resultElement.innerHTML = `Rp ${interest.toFixed(2)}`;
  if (!chartManager.chart) {
    chartManager.createChart(yearlyInterest);
  } else {
    chartManager.updateChart(yearlyInterest);
  }
}
</script>
</html>