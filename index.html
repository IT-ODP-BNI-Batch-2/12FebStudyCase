<!DOCTYPE html>
<html>
<head>
  <title>Savings Calculator</title>
</head>
<body>

<h2>Savings Calculator</h2>

<form>
  <label for="savings">Initial Savings:</label><br>
  <input type="number" id="savings" name="savings"><br>
  <label for="interest">Interest Rate (% Yearly):</label><br>
  <input type="number" step=".01" id="interest" name="interest"><br>
  <label for="period">Period (Year):</label><br>
  <input type="number" id="period" name="period"><br>
  <br>
  <button type="button" onclick="runScript()">Calculate interest</button>
</form> 

<h3 id="result"></h3>

<canvas id="chart"></canvas>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  class SavingsCalculator {
    constructor(initialAmount, interestRate, period) {
      this._initialAmount = initialAmount;
      this._interestRate = interestRate;
      this._period = period;
    }

    calculateInterest() {
      return this._initialAmount * (this._interestRate / 100) * this._period;
    }

    calculateYearlyInterest() {
      const yearlyInterest = [];
      let totalAmount = this._initialAmount;

      for (let year = 1; year <= this._period; year++) {
        const interest = (totalAmount * this._interestRate) / 100;
        totalAmount += interest;
        yearlyInterest.push({ year, interest: interest.toFixed(2), totalAmount });
      }
      return yearlyInterest;
    }
  }

  class ChartManager {
    constructor() {
      this.chart = null;
    }

    createChart(data) {
      const ctx = document.getElementById('chart').getContext('2d');

      this.chart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: data.map(entry => `Year ${entry.year}`),
          datasets: [{
            label: 'Yearly Interest',
            data: data.map(entry => entry.interest),
            borderWidth: 1
          }]
        },
        options: {
          scales: {
            y: {
              beginAtZero: true
            }
          }
        }
      });
    }

    updateChart(data) {
      this.chart.data.labels = data.map(entry => `Year ${entry.year}`);
      this.chart.data.datasets[0].data = data.map(entry => entry.interest);
      this.chart.update();
    }
  }

  const chartManager = new ChartManager();

  function runScript() {
    const initialAmount = parseFloat(document.getElementById('savings').value);
    const interestRate = parseFloat(document.getElementById('interest').value);
    const period = parseFloat(document.getElementById('period').value);

    const calculator = new SavingsCalculator(initialAmount, interestRate, period);
    const yearlyInterest = calculator.calculateYearlyInterest();
    const interest = calculator.calculateInterest();

    const resultElement = document.getElementById('result');
    isNaN(interest) ? resultElement.innerHTML = `Rp 0` : resultElement.innerHTML = `Rp ${interest.toFixed(2)}`;

    if (!chartManager.chart) {
      chartManager.createChart(yearlyInterest);
    } else {
      chartManager.updateChart(yearlyInterest);
    }
  }
</script>
</body>
</html>