<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Savings Interest Calculator</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <h1>Savings Interest Calculator</h1>

    <form id="savingsForm">
        <label for="initialAmount">Initial Amount:</label>
        <input type="number" id="initialAmount" name="initialAmount" required><br><br>

        <label for="interestRate">Interest Rate (in percent):</label>
        <input type="number" id="interestRate" name="interestRate" required><br><br>

        <label for="period">Period (in years):</label>
        <input type="number" id="period" name="period" required><br><br>

        <button type="button" onclick="calculateInterest()">Calculate Interest</button>
    </form>
    <h2>Result</h2>
    <div id="result"></div>
    <canvas id="chart" width="400" height="200"></canvas>


    <script>
        class SavingsCalculator {
            constructor(initialAmount, interestRate, period) {
                this._initialAmount = initialAmount;
                this._interestRate = interestRate;
                this._period = period;
            }

            get initialAmount() {
                return this._initialAmount;
            }

            set initialAmount(value) {
                this._initialAmount = value;
            }

            get interestRate() {
                return this._interestRate;
            }

            set interestRate(value) {
                this._interestRate = value;
            }

            get period() {
                return this._period;
            }

            set period(value) {
                this._period = value;
            }

            calculateInterest() {
                // Implement the interest calculation logic here
                // Formula: Interest = P * r * t
                return this._initialAmount * (this._interestRate / 1200) * this._period;
            }

            calculateYearlyInterest() {
                const yearlyInterest = []
                let totalAmount = this._initialAmount

                for (let year = 1; year <= this._period; year++) {
                    const interest = (totalAmount * this._interestRate) / 100
                    totalAmount += interest
                    let nowYear = year
                    yearlyInterest.push({
                        year: nowYear, interest: interest.toFixed(2), totalAmount: new Intl.NumberFormat('id-ID', {
                            style: 'currency',
                            currency: 'IDR',
                        }).format(totalAmount.toFixed(2))
                    })
                }

                return yearlyInterest
            }
        }

        class ChartManager {
            constructor() {
                this.chart = null
            }

            createChart(data) {
                const ctx = document.getElementById("chart")
                this.chart = new Chart(ctx, {
                    type: "bar",
                    data: {
                        labels: data.map(entry => `${entry.year}`),
                        datasets: [{
                            label: "Yearly Interest",
                            data: data.map(entry => entry.interest),
                            backgroundColor: "rgba(75, 192, 192, 0.2)",
                            borderColor: "rgba(75, 192, 192, 1)",
                            borderWidth: 1
                        }]
                    },
                    options: {
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                })
            }
        }

        function calculateInterest() {
            const initialAmount = parseFloat(document.getElementById('initialAmount').value);
            const interestRate = parseFloat(document.getElementById('interestRate').value);
            const period = parseFloat(document.getElementById('period').value);

            const calculator = new SavingsCalculator(initialAmount, interestRate, period);
            const chartManager = new ChartManager()
            const interest = calculator.calculateInterest();
            const yearlyInterest = calculator.calculateYearlyInterest()

            document.getElementById('result').innerHTML = `Total Interest Earned: ${yearlyInterest[yearlyInterest.length - 1].totalAmount}`;

            if (!chartManager.chart) {
                chartManager.createChart(yearlyInterest);
            } else {
                chartManager.updateChart(yearlyInterest);
            }
        }

    </script>
</body>

</html>