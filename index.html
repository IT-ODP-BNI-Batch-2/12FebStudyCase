
<!DOCTYPE html>
<html lang="en">
<head>
    <title>Case Study 1 - Savings Calculator</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <h1 id="judul">Kalkulator Tabungan!</h1>
    <form action="">
        <label for="savings">Initial Savings:</label><br>
        <input type="number" id="initialAmount" name="savings" placeholder="Masukkan Jumlah Tabungan"><br>
        <br>
        <label for="interest">Interest Rate:</label><br>
        <input type="number" id="interestRate" name="interest" placeholder="Masukkan tingkat suku bunga"><br>
        <br>
        <label for="period">Period:</label><br>
        <input type="number" id="period" name="period" placeholder="Masukkan jangka waktu (bulan)"><br>
        <br>
        <br>
        <button type="button" onclick="calculate()" >Hitung</button>
        <h2 id="totalBunga"></h2>
    </form>

    <script>
        class SavingsCalculator {
            constructor(initialAmount, interestRate, period) {
                this._initialAmount = initialAmount
                this._interestRate = interestRate
                this._period = period
            }

            get initialAmount() {
                return this._InitialAmount
            }

            set initialAmount(value) {
                this._initialAmount = value
            }

            get interestRate() {
                return this._interestRate
            }

            set interestRate(value) {
                this._interestRate = value
            }

            get period() {
                return this._period
            }

            set period(value) {
                this._period = value
            }

            calculateInterest() {
                let total = ((this._initialAmount * (this._interestRate/100) * this._period) / 12)
                console.log(this._initialAmount)
                console.log(this._interestRate)
                console.log(this._period)
                return total.toFixed(2);
            }
        }

        calculateYearlyInterest() {
                const yearlyInterest = []
                let totalAmount = this._initialAmount

                for(let year = 1; year<=this._period; year++){
                    const interest = (totalAmount * this._interestRate) / 100
                    totalAmount = totalAmount + interest
                    yearlyInterest.push({year:year, interest: interest.toFixed(2), totalAmount: totalAmount})
                }

                return yearlyInterest
            }
        

        class ChartManager{
            constructor(){
                this.chart = null
            }
        
            createChart(data){
                const ctx = document.getElementById("chart")
                this.chart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: data.map(entry => 'Year ' + entry.year),
                        datasets: [{
                            label: 'Yearly interest',
                            data: data.map(entry => entry.interest),
                            backgroundColor: 'rgba(75, 192, 192, 0.2)',
                            borderColor: 'rgba(75, 192, 192, 1)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                })
            }
        }
    
        const chartManager = new ChartManager()

        function calculate() {
            let initialAmount = parseFloat(document.getElementById("initialAmount").value)
            let interestRate = parseFloat(document.getElementById("interestRate").value)
            let period = parseFloat(document.getElementById("period").value)
            var total = document.getElementById("totalBunga")
            let calculator = new SavingsCalculator(initialAmount, interestRate, period)
            let interest = calculator.calculateInterest()
            total.innerHTML = 'Interest: ' + interest
        
            const yearlyInterest = counting.calculateYearlyInterest();
            document.getElementById('result').innerHTML = `Total Interest Earned:$${yearlyInterest[yearlyInterest.length - 1].totalAmount}`; 

            // Tambahkan pemanggilan fungsi untuk membuat atau memperbarui grafik
            if (!chartManager.chart) {
                chartManager.createChart(yearlyInterest);
            } else {
                chartManager.updateChart(yearlyInterest);
            }
        }
    
    </script>
</body>
</html>